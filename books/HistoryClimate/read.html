<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>От каменного века до железного — Читать онлайн</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#f4f5f7; color:#222; }
    .toolbar { position: sticky; top:0; z-index:5; display:flex; gap:8px; align-items:center; padding:10px; background:#fff; border-bottom:1px solid #e5e7eb; }
    .toolbar button, .toolbar input { font-size:14px; padding:6px 10px; border-radius:6px; border:1px solid #cbd5e1; background:#fff; }
    .toolbar button:hover { background:#f1f5f9; cursor:pointer; }
    .frame-wrap { height: calc(100vh - 54px); }
    iframe { width:100%; height:100%; border:0; background:#fff; }
  </style>
</head>
<body>
  <div class="toolbar">
    <button id="prev">← Предыдущая</button>
    <button id="next">Следующая →</button>
    <span>Стр. <input id="page" type="number" min="1" value="1" style="width:70px" /></span>
    <span style="flex:1"></span>
    <button id="w">По ширине</button>
    <button id="f">Страница</button>
  </div>

  <div class="frame-wrap">
    <iframe id="viewer" title="PDF"></iframe>
  </div>

  <script>
    // absolute URL to your PDF
    const fileURL = encodeURIComponent("https://genekaliman.github.io/kaliman-books/books/HistoryClimate/History_Climate.pdf");
    // use unpkg viewer (works): 
    const baseViewer = "https://unpkg.com/pdfjs-dist@4.4.168/web/viewer.html";

    let page = 1, zoom = "page-width";
    const frame = document.getElementById("viewer");
    const inp = document.getElementById("page");

    function srcFor(p,z){
      return `${baseViewer}?file=${fileURL}#page=${p}&zoom=${z}&_=${Date.now()}`;
    }
    function update(){
      frame.src = srcFor(page, zoom);
      history.replaceState(null, "", `#p=${page}`);
      inp.value = page;
    }
    const hp = parseInt(location.hash.replace("#p=",""),10);
    if(!isNaN(hp) && hp>0) page = hp;
    update();

    document.getElementById("prev").onclick = ()=>{ page=Math.max(1,page-1); update(); };
    document.getElementById("next").onclick = ()=>{ page=page+1; update(); };
    inp.onchange = ()=>{ const n=parseInt(inp.value,10); if(!isNaN(n)&&n>0){page=n; update();} else inp.value=page; };
    document.getElementById("w").onclick = ()=>{ zoom="page-width"; update(); };
    document.getElementById("f").onclick = ()=>{ zoom="page-fit";   update(); };

    document.addEventListener("keydown", e=>{
      if(e.key==="ArrowLeft"||e.key==="PageUp")   { page=Math.max(1,page-1); update(); }
      if(e.key==="ArrowRight"||e.key==="PageDown"){ page=page+1; update(); }
    });
  </script>
</body>
</html>

